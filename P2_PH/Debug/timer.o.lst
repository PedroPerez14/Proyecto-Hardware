   1              		.cpu arm7tdmi
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 18, 4
  11              		.file	"timer.c"
  21              	.Ltext0:
  22              		.file 1 "../timer.c"
 2151              		.align	2
 2152              	timer2_num_int:
 2153 0000 00000000 		.space	4
 2154              		.text
 2155              		.align	2
 2156              		.global	timer_ISR
 2158              	timer_ISR:
 2159              	.LFB0:
   1:../timer.c    **** /*********************************************************************************************
   2:../timer.c    **** * Fichero:		timer.c
   3:../timer.c    **** * Autor:
   4:../timer.c    **** * Descrip:		funciones de control del timer0 del s3c44b0x
   5:../timer.c    **** * Version:		Modificado para el latido de la práctica 2.
   6:../timer.c    **** *********************************************************************************************/
   7:../timer.c    **** 
   8:../timer.c    **** /*--- ficheros de cabecera ---*/
   9:../timer.c    **** #include "timer.h"
  10:../timer.c    **** #include "44b.h"
  11:../timer.c    **** #include "44blib.h"
  12:../timer.c    **** #include "cola_depuracion.h"
  13:../timer.c    **** #include "codigos_eventos.h"
  14:../timer.c    **** /*--- variables globales ---*/
  15:../timer.c    **** 
  16:../timer.c    **** /* declaración de función que es rutina de servicio de interrupción
  17:../timer.c    ****  * https://gcc.gnu.org/onlinedocs/gcc/ARM-Function-Attributes.html */
  18:../timer.c    **** void timer_ISR(void) __attribute__((interrupt("IRQ")));
  19:../timer.c    **** 
  20:../timer.c    **** /*--- codigo de las funciones ---*/
  21:../timer.c    **** void timer_ISR(void)
  22:../timer.c    **** {
 2160              		.loc 1 22 0
 2161              		.cfi_startproc
 2162              		@ Interrupt Service Routine.
 2163              		@ args = 0, pretend = 0, frame = 0
 2164              		@ frame_needed = 1, uses_anonymous_args = 0
 2165 0000 04C02DE5 		str	ip, [sp, #-4]!
 2166 0004 0DC0A0E1 		mov	ip, sp
 2167              	.LCFI0:
 2168              		.cfi_def_cfa_register 12
 2169 0008 0CD82DE9 		stmfd	sp!, {r2, r3, fp, ip, lr, pc}
 2170 000c 04B04CE2 		sub	fp, ip, #4
 2171              		.cfi_offset 14, -8
 2172              		.cfi_offset 13, -12
 2173              		.cfi_offset 11, -16
 2174              		.cfi_offset 3, -20
 2175              		.cfi_offset 2, -24
 2176              	.LCFI1:
 2177              		.cfi_def_cfa 11, 4
  23:../timer.c    **** 	//push_debug(tick_timer0, no_info);
  24:../timer.c    **** 	/* borrar bit en I_ISPC para desactivar la solicitud de interrupción*/
  25:../timer.c    **** 	rI_ISPC |= BIT_TIMER0; // BIT_TIMER0 está definido en 44b.h y pone un uno en el bit 13 que correpo
 2178              		.loc 1 25 0
 2179 0010 1C309FE5 		ldr	r3, .L2
 2180 0014 18209FE5 		ldr	r2, .L2
 2181 0018 002092E5 		ldr	r2, [r2, #0]
 2182 001c 022A82E3 		orr	r2, r2, #8192
 2183 0020 002083E5 		str	r2, [r3, #0]
  26:../timer.c    **** }
 2184              		.loc 1 26 0
 2185 0024 14D04BE2 		sub	sp, fp, #20
 2186 0028 0C689DE8 		ldmfd	sp, {r2, r3, fp, sp, lr}
 2187 002c 04C09DE4 		ldmfd	sp!, {ip}
 2188 0030 04F05EE2 		subs	pc, lr, #4
 2189              	.L3:
 2190              		.align	2
 2191              	.L2:
 2192 0034 2400E001 		.word	31457316
 2193              		.cfi_endproc
 2194              	.LFE0:
 2196              		.align	2
 2197              		.global	timer_init
 2199              	timer_init:
 2200              	.LFB1:
  27:../timer.c    **** 
  28:../timer.c    **** void timer_init(void)
  29:../timer.c    **** {
 2201              		.loc 1 29 0
 2202              		.cfi_startproc
 2203              		@ Function supports interworking.
 2204              		@ args = 0, pretend = 0, frame = 0
 2205              		@ frame_needed = 1, uses_anonymous_args = 0
 2206 0038 0DC0A0E1 		mov	ip, sp
 2207              	.LCFI2:
 2208              		.cfi_def_cfa_register 12
 2209 003c 00D82DE9 		stmfd	sp!, {fp, ip, lr, pc}
 2210 0040 04B04CE2 		sub	fp, ip, #4
 2211              		.cfi_offset 14, -8
 2212              		.cfi_offset 13, -12
 2213              		.cfi_offset 11, -16
 2214              	.LCFI3:
 2215              		.cfi_def_cfa 11, 4
  30:../timer.c    **** 	/* Configuraion controlador de interrupciones */
  31:../timer.c    **** 	rINTMOD &= ~(BIT_TIMER0); // Configura las linas de timer0 como de tipo IRQ
 2216              		.loc 1 31 0
 2217 0044 0C319FE5 		ldr	r3, .L5
 2218 0048 08219FE5 		ldr	r2, .L5
 2219 004c 002092E5 		ldr	r2, [r2, #0]
 2220 0050 022AC2E3 		bic	r2, r2, #8192
 2221 0054 002083E5 		str	r2, [r3, #0]
  32:../timer.c    **** 	rINTCON &= 0x1; // Habilita int. vectorizadas y la linea IRQ (FIQ la deja como estuviera)
 2222              		.loc 1 32 0
 2223 0058 1E36A0E3 		mov	r3, #31457280
 2224 005c 1E26A0E3 		mov	r2, #31457280
 2225 0060 002092E5 		ldr	r2, [r2, #0]
 2226 0064 012002E2 		and	r2, r2, #1
 2227 0068 002083E5 		str	r2, [r3, #0]
  33:../timer.c    **** 	rINTMSK &= ~(BIT_TIMER0); // habilitamos en vector de mascaras de interrupcion el Timer0 (bits 26 
 2228              		.loc 1 33 0
 2229 006c E8309FE5 		ldr	r3, .L5+4
 2230 0070 E4209FE5 		ldr	r2, .L5+4
 2231 0074 002092E5 		ldr	r2, [r2, #0]
 2232 0078 022AC2E3 		bic	r2, r2, #8192
 2233 007c 002083E5 		str	r2, [r3, #0]
  34:../timer.c    **** 
  35:../timer.c    **** 	/* Establece la rutina de servicio para TIMER0 */
  36:../timer.c    **** 	pISR_TIMER0 = (unsigned) timer_ISR;
 2234              		.loc 1 36 0
 2235 0080 D8309FE5 		ldr	r3, .L5+8
 2236 0084 D8209FE5 		ldr	r2, .L5+12
 2237 0088 002083E5 		str	r2, [r3, #0]
  37:../timer.c    **** 
  38:../timer.c    **** 	/* Configura el Timer0 a resolución de 1e-4 segundos para el latido */
  39:../timer.c    **** 	rTCFG0 &= 0xffffff00;
 2238              		.loc 1 39 0
 2239 008c D4309FE5 		ldr	r3, .L5+16
 2240 0090 D0209FE5 		ldr	r2, .L5+16
 2241 0094 002092E5 		ldr	r2, [r2, #0]
 2242 0098 FF20C2E3 		bic	r2, r2, #255
 2243 009c 002083E5 		str	r2, [r3, #0]
  40:../timer.c    **** 	rTCFG0 |= 0xc7; 		// ajusta el preescalado del timer 0 a 199 (200 de forma interna) para el latido
 2244              		.loc 1 40 0
 2245 00a0 C0309FE5 		ldr	r3, .L5+16
 2246 00a4 BC209FE5 		ldr	r2, .L5+16
 2247 00a8 002092E5 		ldr	r2, [r2, #0]
 2248 00ac C72082E3 		orr	r2, r2, #199
 2249 00b0 002083E5 		str	r2, [r3, #0]
  41:../timer.c    **** 	rTCFG1 &= 0xffffff0;
 2250              		.loc 1 41 0
 2251 00b4 B0309FE5 		ldr	r3, .L5+20
 2252 00b8 AC209FE5 		ldr	r2, .L5+20
 2253 00bc 002092E5 		ldr	r2, [r2, #0]
 2254 00c0 FF22C2E3 		bic	r2, r2, #-268435441
 2255 00c4 002083E5 		str	r2, [r3, #0]
  42:../timer.c    **** 	rTCFG1 |= 0xffffff7;    // selecciona la entrada del mux que proporciona el reloj 0. La 1xx (0x...
 2256              		.loc 1 42 0
 2257 00c8 9C209FE5 		ldr	r2, .L5+20
 2258 00cc 98309FE5 		ldr	r3, .L5+20
 2259 00d0 003093E5 		ldr	r3, [r3, #0]
 2260 00d4 0330E0E1 		mvn	r3, r3
 2261 00d8 8F3203E2 		and	r3, r3, #-268435448
 2262 00dc 0330E0E1 		mvn	r3, r3
 2263 00e0 003082E5 		str	r3, [r2, #0]
  43:../timer.c    **** 	rTCNTB0 = 166;			// valor inicial de cuenta. Con esto hay una interrupción cada 1/60 de segundo.
 2264              		.loc 1 43 0
 2265 00e4 84309FE5 		ldr	r3, .L5+24
 2266 00e8 A620A0E3 		mov	r2, #166
 2267 00ec 002083E5 		str	r2, [r3, #0]
  44:../timer.c    **** 	rTCMPB0 = 0;			// valor de comparación
 2268              		.loc 1 44 0
 2269 00f0 7C309FE5 		ldr	r3, .L5+28
 2270 00f4 0020A0E3 		mov	r2, #0
 2271 00f8 002083E5 		str	r2, [r3, #0]
  45:../timer.c    **** 	/* establecer update=manual (bit 1) + inverter=on (¿? será inverter off un cero en el bit 2 pone e
  46:../timer.c    **** 	rTCON &= 0xfffffff0;
 2272              		.loc 1 46 0
 2273 00fc 74309FE5 		ldr	r3, .L5+32
 2274 0100 70209FE5 		ldr	r2, .L5+32
 2275 0104 002092E5 		ldr	r2, [r2, #0]
 2276 0108 0F20C2E3 		bic	r2, r2, #15
 2277 010c 002083E5 		str	r2, [r3, #0]
  47:../timer.c    **** 	rTCON |= 0x00000002;
 2278              		.loc 1 47 0
 2279 0110 60309FE5 		ldr	r3, .L5+32
 2280 0114 5C209FE5 		ldr	r2, .L5+32
 2281 0118 002092E5 		ldr	r2, [r2, #0]
 2282 011c 022082E3 		orr	r2, r2, #2
 2283 0120 002083E5 		str	r2, [r3, #0]
  48:../timer.c    **** 	/* iniciar timer (bit 0) con auto-reload (bit 3)*/
  49:../timer.c    **** 	rTCON &= 0xfffffff0;
 2284              		.loc 1 49 0
 2285 0124 4C309FE5 		ldr	r3, .L5+32
 2286 0128 48209FE5 		ldr	r2, .L5+32
 2287 012c 002092E5 		ldr	r2, [r2, #0]
 2288 0130 0F20C2E3 		bic	r2, r2, #15
 2289 0134 002083E5 		str	r2, [r3, #0]
  50:../timer.c    **** 	rTCON |= 0x00000009;
 2290              		.loc 1 50 0
 2291 0138 38309FE5 		ldr	r3, .L5+32
 2292 013c 34209FE5 		ldr	r2, .L5+32
 2293 0140 002092E5 		ldr	r2, [r2, #0]
 2294 0144 092082E3 		orr	r2, r2, #9
 2295 0148 002083E5 		str	r2, [r3, #0]
  51:../timer.c    **** }
 2296              		.loc 1 51 0
 2297 014c 0CD04BE2 		sub	sp, fp, #12
 2298 0150 00689DE8 		ldmfd	sp, {fp, sp, lr}
 2299 0154 1EFF2FE1 		bx	lr
 2300              	.L6:
 2301              		.align	2
 2302              	.L5:
 2303 0158 0800E001 		.word	31457288
 2304 015c 0C00E001 		.word	31457292
 2305 0160 54FF7F0C 		.word	209715028
 2306 0164 00000000 		.word	timer_ISR
 2307 0168 0000D501 		.word	30736384
 2308 016c 0400D501 		.word	30736388
 2309 0170 0C00D501 		.word	30736396
 2310 0174 1000D501 		.word	30736400
 2311 0178 0800D501 		.word	30736392
 2312              		.cfi_endproc
 2313              	.LFE1:
 2315              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 timer.c
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2151   .bss:00000000 $d
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2152   .bss:00000000 timer2_num_int
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2155   .text:00000000 $a
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2158   .text:00000000 timer_ISR
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2192   .text:00000034 $d
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2196   .text:00000038 $a
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2199   .text:00000038 timer_init
C:\Users\guest\AppData\Local\Temp\ccOiWyVL.s:2303   .text:00000158 $d
                     .debug_frame:00000010 $d

NO UNDEFINED SYMBOLS
